(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{9319:function(e,n,t){Promise.resolve().then(t.bind(t,4828))},4828:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ei}});var r=t(9268),i=t(3383),a=t(6649),l=t(2805),s=t(2120),o=t(3335),d=t(5728);function u(){let e=(0,l._)(["\n    from {\n        transform: rotate(0deg);\n    }\n    to {\n        transform: rotate(360deg);\n    }\n    "]);return u=function(){return e},e}function m(){let e=(0,l._)(["\n  display: inline-block;\n  animation: "," 2s linear infinite;\n  transform-origin: center center;\n  line-height: 1;\n"]);return m=function(){return e},e}let c=(0,s.keyframes)(u()),h=o.default.span(m(),c),x=e=>(0,r.jsx)(h,{children:(0,r.jsx)(d.Z,{...e})});var p=t(5002),g=t(6994),f=t(6006),j=t(3196);let y=()=>{let{scoreboard:e}=(0,g.ek)(),[n,t]=(0,f.useState)(!1),[r,i]=(0,f.useState)(null),[a,l]=(0,f.useState)(new Set),[s,o]=(0,f.useState)(new Set),[d,u]=(0,f.useState)(new Map);(0,f.useEffect)(()=>{u(new Map(e.map((e,n)=>[e.handle,n])))},[e]);let m=(0,f.useMemo)(()=>{let n=new Map;return e.map(e=>{let n=e.scoreEntries.map(n=>"game"in n&&s.has([n.game.uuid,e.handle].join(":"))?{...n,frozen:!1}:n),t=n.reduce((e,n)=>e+(n.frozen?0:n.score),0);return{...e,scoreEntries:n,score:t}}).sort((e,n)=>e.score!==n.score?n.score-e.score:e.lastScoreUpdateTime-n.lastScoreUpdateTime).map((e,t)=>{var r;let i="".concat(e.score,"-").concat(e.lastScoreUpdateTime),a=null!==(r=n.get(i))&&void 0!==r?r:t+1;return n.set(i,a),{...e,rank:a}}).sort((e,n)=>{var t,r;let i=null!==(t=d.get(e.handle))&&void 0!==t?t:e.rank,a=null!==(r=d.get(n.handle))&&void 0!==r?r:n.rank;return i-a})},[s,d,e]);(0,j.F)(()=>{(null==r?void 0:r.phase.type)==="user-out"&&u(new Map(m.sort((e,n)=>e.rank-n.rank).map((e,n)=>[e.handle,n])))},[null==r?void 0:r.phase.type],[m]);let{handle:c}=(0,f.useMemo)(()=>{let e=m.reduce((e,n)=>{let t=a.has(n.handle);return!t&&n.rank>e.rank||!t&&n.rank===e.rank&&n.handle.localeCompare(e.handle)?{rank:n.rank,handle:n.handle}:e},{rank:0,handle:""});return e},[a,m]),{handle:h,uuid:x}=(0,f.useMemo)(()=>{let e=m.reduce((e,n)=>{let t=n.scoreEntries.find(e=>e.frozen);return t&&"game"in t&&n.rank>e.rank||t&&"game"in t&&n.rank===e.rank&&n.handle.localeCompare(e.handle)?{rank:n.rank,handle:n.handle,uuid:t.game.uuid}:e},{rank:0,handle:"",uuid:""});return e},[m]),p=()=>{if(null===r)return{handle:c,phase:{type:"user-in"}};let{handle:e,phase:n}=r;if("user-in"===n.type)return h===e?{handle:e,phase:{type:"user-game-in",uuid:x}}:(l(n=>new Set(n.add(e))),{handle:e,phase:{type:"user-out"}});if("user-game-in"===n.type)return o(t=>new Set(t.add([n.uuid,e].join(":")))),{handle:e,phase:{type:"user-game-out",uuid:n.uuid}};if("user-game-out"===n.type)return e===h?{handle:e,phase:{type:"user-game-in",uuid:x}}:{handle:e,phase:{type:"user-out"}};if("user-out"===n.type)return e===c?(l(n=>new Set(n.add(e))),{handle:e,phase:{type:"user-out"}}):{handle:c,phase:{type:"user-in"}};throw Error("unreachable")},y=()=>{console.log("next phase",p()),i(p())};return{awardMode:n,setAwardMode:t,unfrozen:m,phase:r,onNextPhase:y,finishedUsers:a}};var v=t(2665),k=t(1835),w=t(7743),b=t(5876),S=t(6008),T=t(9519);let E=e=>{let{data:n}=e,t=(0,v.Z)(n.startedAt),i=(0,T.r)(n.gameId),l="적정 플레이 시간: ".concat(i.estimatedPlayTime.min," - ").concat(i.estimatedPlayTime.max,"분");return(0,r.jsx)(k.u,{title:l,children:(0,r.jsxs)("span",{children:[(0,r.jsx)(a.Z,{emoji:i.emoji})," ",(0,r.jsx)("span",{children:i.name})," ",(0,r.jsxs)(k.Jd,{description:!0,children:[Math.floor(t/60/1e3),(0,r.jsx)(k.Jd,{small:!0,children:"분"})]})]})})};var F=t(4945),P=t(5550),_=t(555),J=t(4445),Z=t(4086);function M(){let e=(0,l._)(["\n  text-align: right;\n"]);return M=function(){return e},e}let z=o.default.div(M()),C=e=>{let{data:n,current:t}=e,i="solves"===n.type?"custom":n.game.gameId,l=(0,T.r)(i),s="solves"===n.type?0:n.game.finishedAt-n.game.startedAt,o=(0,f.useRef)(null);return(0,f.useEffect)(()=>{t&&o.current&&o.current.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})},[t]),(0,r.jsxs)(z,{ref:o,style:{...n.frozen?{opacity:.5}:{},...t?{boxShadow:"0 0 8px 2px white",background:"white",opacity:1}:{}},children:[(0,r.jsx)(k.Jd,{h3:!0,"no-margin":!0,tabular:!0,as:"span",style:{fontWeight:"initial"},children:n.frozen?(0,r.jsx)(k.Jd,{description:!0,children:(0,r.jsx)(J.Z,{})}):(0,r.jsx)(F.Z,{value:n.score})}),(0,r.jsx)(k.Jd,{description:!0,children:"solves"===n.type?(0,r.jsxs)(r.Fragment,{children:["=",n.solves," ",(0,r.jsx)(k.u,{title:"보드게임컵 솔브 수",children:(0,r.jsx)(a.Z,{emoji:"\uD83C\uDFC6"})})]}):(0,r.jsxs)(r.Fragment,{children:[n.frozen?(0,r.jsxs)(r.Fragment,{children:[Math.floor(s/60/1e3),(0,r.jsx)(k.Jd,{small:!0,children:"분"})]}):(0,r.jsxs)(r.Fragment,{children:["#",n.result.rank]})," ",(0,r.jsx)(k.u,{title:l.name,children:(0,r.jsx)(a.Z,{emoji:l.emoji})})]})})]})};function I(){let e=(0,l._)(["\n  text-align: right;\n"]);return I=function(){return e},e}let D=o.default.div(I()),A=e=>{let{data:n}=e,{gameId:t}=n,i=(0,T.r)(t),l=(0,v.Z)(n.startedAt);return(0,r.jsxs)(D,{children:[(0,r.jsxs)(k.Jd,{h3:!0,"no-margin":!0,tabular:!0,description:!0,as:"span",style:{fontWeight:"initial"},children:[(0,r.jsx)(x,{}),"\xa0"]}),(0,r.jsxs)(k.Jd,{description:!0,tabular:!0,children:[Math.floor(l/60/1e3),(0,r.jsx)(k.Jd,{small:!0,children:"분"})," ",(0,r.jsx)(k.u,{title:i.name,children:(0,r.jsx)(a.Z,{emoji:i.emoji})})]})]})};function N(){let e=(0,l._)(["\n  position: relative;\n  white-space: nowrap;\n  word-break: keep-all;\n  height: 96px;\n  direction: ltr;\n  background: ",";\n  @media (min-width: 768px) {\n    height: 72px;\n  }\n"]);return N=function(){return e},e}function O(){let e=(0,l._)(["\n  position: sticky;\n  padding: 16px;\n  vertical-align: middle;\n  left: 0;\n  width: 216px;\n  background: linear-gradient(\n    to right,\n    ",",\n    "," 80%,\n    transparent\n  );\n"]);return O=function(){return e},e}function R(){let e=(0,l._)(["\n  display: flex;\n"]);return R=function(){return e},e}function U(){let e=(0,l._)(["\n  position: sticky;\n  padding: 16px;\n  vertical-align: middle;\n  right: 0;\n  width: 240px;\n  text-align: right;\n  background: linear-gradient(\n    to left,\n    ",",\n    "," 80%,\n    transparent\n  );\n"]);return U=function(){return e},e}function G(){let e=(0,l._)(["\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n"]);return G=function(){return e},e}function L(){let e=(0,l._)(["\n  vertical-align: middle;\n  @media (max-width: 768px) {\n    display: none;\n  }\n"]);return L=function(){return e},e}function V(){let e=(0,l._)(["\n  direction: ltr;\n  vertical-align: middle;\n  @media (min-width: 768px) {\n    display: none;\n  }\n"]);return V=function(){return e},e}function W(){let e=(0,l._)(["\n  display: grid;\n  grid-auto-flow: column;\n  grid-auto-columns: 80px;\n  gap: 0 24px;\n"]);return W=function(){return e},e}function X(){let e=(0,l._)(["\n  display: inline-block;\n  width: 1.5rem;\n  height: 1.5rem;\n  text-align: center;\n  font-size: 0.9em;\n  font-weight: 800;\n  background: ",";\n  color: ",";\n"]);return X=function(){return e},e}let B=(0,o.default)(b.E.tr)(N(),e=>{let{theme:n}=e;return n.color.background.page}),q=o.default.td(O(),e=>{let{theme:n}=e;return n.color.background.page},e=>{let{theme:n}=e;return n.color.background.page}),H=o.default.div(R()),K=o.default.td(U(),e=>{let{theme:n}=e;return n.color.background.page},e=>{let{theme:n}=e;return n.color.background.page}),Q=o.default.div(G()),Y=o.default.td(L()),$=o.default.tr(V()),ee=o.default.div(W()),en=o.default.div(X(),e=>{let{theme:n}=e;return n.color.text.primary.dark},e=>{let{theme:n}=e;return n.color.text.primary.light}),et=(e,n)=>{let t=(0,_.u)(),{type:r}=(null==e?void 0:e.phase)||{};return!r&&n?(0,Z.CD)(.2,t.color.text.secondary.main,"white"):"user-in"===r||"user-game-in"===r||"user-game-out"===r?(0,Z.CD)(.2,t.color.status.warn,"white"):"user-out"===r?(0,Z.CD)(.2,t.color.solvedAc,"white"):t.color.background.page},er=e=>{var n,t;let{user:i,phase:a,finished:l}=e,s=et(a,l),o=(0,f.useRef)(null);return(0,f.useEffect)(()=>{var e,n;(null==a?void 0:null===(e=a.phase)||void 0===e?void 0:e.type)==="user-in"&&(null===(n=o.current)||void 0===n||n.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}))},[null==a?void 0:null===(n=a.phase)||void 0===n?void 0:n.type]),(0,r.jsxs)(_.a,{theme:{color:{...P.r.color,background:{...P.r.color.background,page:s}}},children:[(0,r.jsxs)(B,{layoutId:i.handle,ref:o,style:{zIndex:(null==a?void 0:null===(t=a.phase)||void 0===t?void 0:t.type)==="user-out"?1e4:0},children:[(0,r.jsx)(K,{children:(0,r.jsxs)(Q,{children:[0!==i.ongoingGames.length&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.Jd,{description:!0,children:(0,r.jsx)(x,{})}),(0,r.jsx)(k.T,{w:8})]}),i.scoreEntries.find(e=>null===e.score)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.Jd,{description:!0,children:(0,r.jsx)(J.Z,{})}),(0,r.jsx)(k.T,{w:8})]}):null,(0,r.jsx)(k.Jd,{h2:!0,"no-margin":!0,tabular:!0,as:"span",children:(0,r.jsx)(F.Z,{value:i.score})})]})}),(0,r.jsx)(Y,{children:(0,r.jsxs)(ee,{children:[i.scoreEntries.map(e=>{var n;return(0,r.jsx)(C,{data:e,current:(null==a?void 0:null===(n=a.phase)||void 0===n?void 0:n.type)==="user-game-in"&&"game"===e.type&&a.phase.uuid===e.game.uuid},"solves"===e.type?"solves":e.game.uuid)}),i.ongoingGames.map(e=>(0,r.jsx)(A,{data:e},e.gameId))]})}),(0,r.jsx)(q,{children:(0,r.jsxs)(H,{children:[(0,r.jsx)(en,{children:(0,r.jsx)(F.Z,{value:i.rank})}),(0,r.jsx)(k.T,{w:8}),(0,r.jsxs)(k.Jd,{ellipsis:!0,children:[(0,r.jsx)("span",{children:i.handle}),i.exclude&&(0,r.jsx)(k.Jd,{description:!0,children:" (스탭)"})]})]})})]}),(0,r.jsx)($,{children:(0,r.jsx)("td",{colSpan:2,style:{paddingBottom:16,paddingRight:16},children:(0,r.jsxs)(ee,{children:[i.scoreEntries.map(e=>{var n;return(0,r.jsx)(C,{data:e,current:(null==a?void 0:null===(n=a.phase)||void 0===n?void 0:n.type)==="user-game-in"&&"game"===e.type&&a.phase.uuid===e.game.uuid},"solves"===e.type?"solves":e.game.uuid)}),i.ongoingGames.map(e=>(0,r.jsx)(A,{data:e},e.gameId))]})})})]})};function ei(){let e=(0,p.aC)(),{gamesLoaded:n,freezeAt:t}=(0,g.ek)(),{awardMode:l,setAwardMode:s,unfrozen:o,phase:d,onNextPhase:u,finishedUsers:m}=y(),c=(0,v.Z)(t),h=Math.floor(-c/1e3),j=(0,S.useSearchParams)(),T="true"===(j.get("award")||"");(0,f.useEffect)(()=>{T&&e.isAdmin?s(T):s(!1)},[e.isAdmin,T,s]),(0,f.useEffect)(()=>{if(!l)return;let e=e=>{" "===e.key&&(e.preventDefault(),u())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l,u]);let F=(0,f.useMemo)(()=>Array.from(new Set(o.flatMap(e=>e.ongoingGames))).sort((e,n)=>e.startedAt-n.startedAt),[o]);return n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{padding:16,overflowX:"auto"},children:[0!==F.length&&(0,r.jsxs)(r.Fragment,{children:["현재 플레이 중:"," ",F.map((e,n)=>{let{gameId:t}=e;return(0,r.jsxs)(f.Fragment,{children:[0!==n&&", ",(0,r.jsx)(E,{data:e})]},t)})]}),(0,r.jsx)(k.T,{h:4}),(0,r.jsx)(k.iz,{margin:"none"}),(0,r.jsx)(k.T,{h:4}),"플레이어 대기 중:"," ",i.filter(e=>"custom"!==e.id&&F.every(n=>n.gameId!==e.id)).map((e,n)=>(0,r.jsxs)(f.Fragment,{children:[0!==n&&", ",(0,r.jsx)(a.Z,{emoji:e.emoji})," ",e.name]},e.id)),(0,r.jsx)(k.T,{h:8}),3600>=h&&h>60&&(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(k.Jd,{description:!0,tabular:!0,children:[Math.floor(h/60),"분 후 프리즈"]})}),60>=h&&h>0&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(k.Jd,{success:!0,tabular:!0,children:(0,r.jsxs)("b",{children:[h,"초 후 프리즈"]})})}),h<=0&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(k.Jd,{success:!0,tabular:!0,children:(0,r.jsx)("b",{children:"스코어보드 프리즈됨"})})})]}),(0,r.jsx)("div",{style:{position:"relative",overflowX:"auto",direction:"rtl"},children:(0,r.jsx)("table",{style:{width:"100%"},children:(0,r.jsx)(w.M,{children:(0,r.jsx)(b.E.tbody,{layout:!0,layoutRoot:!0,transition:{ease:"easeInOut",duration:1},children:o.map(e=>(0,r.jsxs)(f.Fragment,{children:[(0,r.jsx)(er,{user:e,finished:m.has(e.handle),phase:(null==d?void 0:d.handle)===e.handle?d:null}),(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:3,children:(0,r.jsx)(k.iz,{margin:"none"})})})]},e.handle))})})})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(k.T,{h:64}),(0,r.jsx)(k.at,{style:{fontSize:"4em"},children:(0,r.jsx)(x,{})}),(0,r.jsx)(k.T,{h:64})]})}},4945:function(e,n,t){"use strict";var r=t(9268),i=t(3196),a=t(4355),l=t(182),s=t(6006);let o=e=>e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}),d=e=>{let{value:n,format:t=o}=e,d=(0,s.useRef)(null),u=(0,a.c)(0);return(0,i.F)(()=>{(0,l.j)(u,n,{duration:.5,ease:"easeOut"})},[n],[u]),(0,s.useEffect)(()=>u.onChange(e=>{d.current&&(d.current.textContent=t(e))}),[t,u]),(0,r.jsx)("span",{ref:d,children:t(n)})};n.Z=d},6649:function(e,n,t){"use strict";var r=t(2805),i=t(9268),a=t(3335),l=t(1527);function s(){let e=(0,r._)(["\n  height: 1.2em;\n  width: 1.2em;\n  margin: 0 0.05em 0 0.1em;\n  vertical-align: -0.25em;\n"]);return s=function(){return e},e}let o=e=>"https://twemoji.maxcdn.com/v/latest/72x72/".concat(e,".png"),d=a.default.img(s()),u=e=>{let{emoji:n}=e;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(d,{src:o(l.Z.convert.toCodePoint(n)),alt:n})})};n.Z=u},2665:function(e,n,t){"use strict";var r=t(6006);let i=e=>{let[n,t]=(0,r.useState)(Date.now()),[i,a]=(0,r.useState)(0);return(0,r.useEffect)(()=>{let e=setInterval(()=>{t(Date.now())},1e3);return()=>{clearInterval(e)}},[]),(0,r.useEffect)(()=>{e instanceof Date?a(n-e.getTime()):a(n-e)},[n,e]),i};n.Z=i},5550:function(e,n,t){"use strict";t.d(n,{r:function(){return i}});var r=t(1835);let i={...r.Sk.light,color:{...r.Sk.light.color,text:{...r.Sk.light.color.text,primary:{...r.Sk.light.color.text.primary,dark:"#303538",main:"#303538"}}}}},9519:function(e,n,t){"use strict";t.d(n,{r:function(){return i}});var r=t(3383);let i=e=>r.find(n=>n.id===e)},3383:function(e){"use strict";e.exports=JSON.parse('[{"id":"terraforming-mars","name":"테라포밍 마스","emoji":"\uD83C\uDF0D","players":{"min":1,"max":5},"estimatedPlayTime":{"min":90,"max":120}},{"id":"sakura-arms","name":"벚꽃 내리는 시대에 결투를","emoji":"\uD83C\uDF38","players":{"min":2,"max":2},"estimatedPlayTime":{"min":10,"max":20}},{"id":"halli-galli","name":"할리갈리","emoji":"\uD83C\uDF4B","players":{"min":2,"max":7},"estimatedPlayTime":{"min":5,"max":15}},{"id":"chess","name":"체스","emoji":"♟","players":{"min":2,"max":2},"estimatedPlayTime":{"min":30,"max":60}},{"id":"crazy-time","name":"크레이지 타임","emoji":"\uD83D\uDD70","players":{"min":3,"max":14},"estimatedPlayTime":{"min":20,"max":30}},{"id":"dominion","name":"도미니언","emoji":"\uD83C\uDFF0","players":{"min":2,"max":4},"estimatedPlayTime":{"min":30,"max":40}},{"id":"splendor","name":"스플렌더","emoji":"\uD83D\uDC8E","players":{"min":2,"max":4},"estimatedPlayTime":{"min":20,"max":30}},{"id":"yacht-dice","name":"요트 다이스","emoji":"\uD83C\uDFB2","players":{"min":1,"max":20},"estimatedPlayTime":{"min":5,"max":20}},{"id":"no-thanks","name":"노 땡스!","emoji":"\uD83D\uDE45‍♂️","players":{"min":3,"max":7},"estimatedPlayTime":{"min":20,"max":30}},{"id":"uno","name":"UNO","emoji":"\uD83C\uDCCF","players":{"min":2,"max":10},"estimatedPlayTime":{"min":20,"max":30}},{"id":"bang","name":"뱅!","emoji":"\uD83D\uDD2B","players":{"min":4,"max":7},"estimatedPlayTime":{"min":20,"max":40}},{"id":"zenga","name":"젠가","emoji":"\uD83D\uDCE6","players":{"min":1,"max":8},"estimatedPlayTime":{"min":5,"max":20}},{"id":"richii-mahjong","name":"리치 마작","emoji":"\uD83C\uDC04","players":{"min":3,"max":4},"estimatedPlayTime":{"min":30,"max":60}},{"id":"custom","name":"직접 입력","emoji":"\uD83D\uDCDD","players":{"min":1,"max":20},"estimatedPlayTime":{"min":5,"max":120}}]')}},function(e){e.O(0,[3169,8454,759,4770,5697,9146,3229,3347,6308,5066,2667,8139,1744],function(){return e(e.s=9319)}),_N_E=e.O()}]);