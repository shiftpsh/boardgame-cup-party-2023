(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[853],{4910:function(e,t,n){Promise.resolve().then(n.bind(n,2531))},2531:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var s=n(2805),a=n(9268),l=n(3133),i=n(1835),r=n(6006),o=n(6628),d=n(2665);let c=e=>{let{start:t}=e,n=(0,d.Z)(t),s=Math.floor(n/1e3);return(0,a.jsx)(a.Fragment,{children:[Math.floor(s/60).toString().padStart(2,"0"),(s%60).toString().padStart(2,"0")].join(":")})};var h=n(6649),m=n(5002),u=n(475),p=n(6192),y=n(3328),x=n(9519),j=n(3335),v=n(6212),f=n(8941),g=n(2166),w=n(5873),b=n(9545),T=n(1313),k=n(4890),L=n(5846),A=n.n(L),S=n(6462);function C(){let e=(0,s._)(["\n  display: flex;\n  flex-wrap: wrap;\n  gap: 8px;\n"]);return C=function(){return e},e}let P=j.default.div(C());function Z(){let e=(0,m.aC)(),t=(0,u.Ds)(),n=(0,p.Z)(),[s,d]=(0,r.useState)("terraforming-mars"),[j,L]=(0,r.useState)([]),[C,Z]=(0,r.useState)(""),[J,_]=(0,r.useState)(!1),z=(0,r.useRef)(null),W=(0,r.useMemo)(()=>n.filter(e=>!("finishedAt"in e)).sort((e,t)=>t.startedAt-e.startedAt),[n]),E=(0,x.r)(s),O=(0,r.useMemo)(()=>{let e=C.trim().toLocaleLowerCase();return e.length?o.filter(t=>{if(j.find(e=>e===t.handle))return!1;let n=W.find(e=>e.players.includes(t.handle));return!n&&!!t.handle.toLocaleLowerCase().includes(e)}).sort((t,n)=>{let s=t.handle.toLocaleLowerCase().startsWith(e),a=n.handle.toLocaleLowerCase().startsWith(e);return s==a?t.handle.localeCompare(n.handle):s?-1:1}):[]},[W,j,C]),D=(0,r.useMemo)(()=>{let e=[];j.length<2&&e.push("플레이어 수(".concat(j.length,"명)가 2명 미만")),j.length<E.players.min&&e.push("플레이어 수(".concat(j.length,"명)가 ").concat(E.name," 권장 최소 플레이어 수(").concat(E.players.min,"명)보다 적음")),j.length>E.players.max&&e.push("플레이어 수(".concat(j.length,"명)가 ").concat(E.name," 권장 최대 플레이어 수(").concat(E.players.max,"명)보다 많음")),W.find(e=>e.gameId===s)&&e.push("진행 중인 ".concat(E.name," 게임이 있음")),j.forEach(t=>{let n=W.find(e=>e.players.includes(t));n&&e.push("".concat(t,"님이 이미 ").concat((0,x.r)(n.gameId).name," 게임을 진행 중"))});let t=j.map(e=>{let t=n.filter(e=>"finishedAt"in e).filter(t=>t.players.includes(e)).sort((e,t)=>t.startedAt-e.startedAt);return t.length>0?{player:e,lastGame:t[0],uuid:t[0].uuid}:{player:e,lastGame:null,uuid:null}});t.forEach(t=>{if(!t.lastGame)return;let n=t.lastGame;n.gameId===s&&e.push("".concat(t.player,"님이 직전에 ").concat(E.name,"를 플레이함"))});let a=new Set(t.map(e=>e.uuid).filter(e=>null!==e));if(1===a.size){var l;let s=a.values().next().value,i=n.find(e=>e.uuid===s),r=new Set(null!==(l=null==i?void 0:i.players)&&void 0!==l?l:[]),o=new Set(t.map(e=>e.player));if(r.size===o.size){let t=new Set(Array.from(o).filter(e=>!r.has(e)));0===t.size&&e.push("이 플레이어 집합은 직전에 동일한 플레이어 집합으로 ".concat(E.name,"를 플레이함"))}}return e},[E.name,E.players.max,E.players.min,s,n,W,j]),M=e=>{if(!z.current)return;let t=o.find(t=>t.handle===e);t&&(L(t=>t.find(t=>t===e)?t:[...t,e]),Z(""),z.current.focus())},F=e=>{L(t=>t.filter(t=>t!==e))},I=async()=>{if(J)return;_(!0);let e=(0,S.Z)();try{await (0,k.t8)((0,k.iH)(y.db,"games/".concat(e)),{uuid:e,startedAt:Date.now(),gameId:s,players:j}),t.enqueue({message:"게임이 추가되었습니다.",severity:"success"}),L([])}catch(e){e instanceof T.ZR?t.enqueue({message:"게임 추가에 실패했습니다: ".concat(e.message),severity:"error"}):t.enqueue({message:"게임 추가에 실패했습니다.",severity:"error"})}_(!1)};return e.isAdmin?(0,a.jsxs)(i.W2,{children:[(0,a.jsx)(i.T,{h:64}),(0,a.jsx)(i.Jd,{h2:!0,as:"h1",children:"진행 중인 게임"}),0===W.length?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.at,{children:"진행 중인 게임이 없습니다."})}):(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(i.xJ,{children:(0,a.jsxs)(i.iA,{fullWidth:!0,style:{tableLayout:"fixed"},padding:"dense",children:[(0,a.jsx)(i.ss,{children:(0,a.jsxs)(i.X2,{children:[(0,a.jsx)(i.bL,{width:"20%",children:"게임"}),(0,a.jsx)(i.bL,{width:"40%",children:"플레이어"}),(0,a.jsx)(i.bL,{width:"20%",children:"시간"}),(0,a.jsx)(i.bL,{width:"20%",children:"수정"})]})}),(0,a.jsx)(i.RM,{children:W.map(e=>(0,a.jsxs)(i.X2,{children:[(0,a.jsx)(i.bL,{children:(0,a.jsxs)(i.Jd,{ellipsis:!0,style:{verticalAlign:"middle"},children:[(0,a.jsx)(h.Z,{emoji:(0,x.r)(e.gameId).emoji})," ",(0,x.r)(e.gameId).name]})}),(0,a.jsx)(i.bL,{children:(0,a.jsx)(i.Jd,{ellipsis:!0,style:{verticalAlign:"middle"},children:e.players.join(", ")})}),(0,a.jsx)(i.bL,{style:{textAlign:"center"},children:(0,a.jsx)(i.Jd,{tabular:!0,children:(0,a.jsx)(c,{start:e.startedAt})})}),(0,a.jsx)(i.bL,{padding:"none",children:(0,a.jsx)(A(),{href:"/add/commit?uuid=".concat(e.uuid),children:(0,a.jsx)(i.zx,{fullWidth:!0,transparent:!0,children:(0,a.jsx)(v.Z,{})})})})]},e.uuid))})]})})}),(0,a.jsx)(i.T,{h:64}),(0,a.jsx)(i.Jd,{h2:!0,as:"h1",children:"새 게임 추가"}),(0,a.jsx)(i.Jd,{h4:!0,as:"h2",children:"게임"}),(0,a.jsx)(l.Z,{value:s,onChange:e=>{let{value:t}=e;return d(t)},fullWidth:!0}),(0,a.jsx)(i.T,{h:8}),(0,a.jsxs)(i.Jd,{h4:!0,as:"h2",children:["플레이어",(0,a.jsxs)(i.Jd,{description:!0,style:{fontWeight:"normal"},children:[(0,a.jsx)(f.Z,{})," ",j.length,"명"]})]}),(0,a.jsx)(i.qo,{ref:z,placeholder:"유저 검색",value:C,onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),O.length>=1&&M(O[0].handle))},onChange:e=>{let{target:{value:t}}=e;return Z(t)},fullWidth:!0}),(0,a.jsx)(i.T,{h:16}),(0,a.jsx)(P,{children:O.slice(0,10).map(e=>(0,a.jsxs)(i.zx,{onClick:()=>M(e.handle),children:[e.handle,"staff"===e.type&&(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)(i.Jd,{description:!0,children:"(스탭)"})]})]},e.handle))}),(0,a.jsx)(i.T,{h:16}),0===j.length?(0,a.jsx)(i.at,{children:"게임을 입력하지 않았습니다."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.iA,{fullWidth:!0,padding:"dense",children:[(0,a.jsx)(i.ss,{children:(0,a.jsxs)(i.X2,{children:[(0,a.jsx)(i.bL,{children:"핸들"}),(0,a.jsx)(i.bL,{children:"삭제"})]})}),(0,a.jsx)(i.RM,{children:j.map(e=>(0,a.jsxs)(i.X2,{children:[(0,a.jsx)(i.bL,{children:e}),(0,a.jsx)(i.bL,{padding:"none",children:(0,a.jsx)(i.zx,{onClick:()=>F(e),fullWidth:!0,transparent:!0,children:(0,a.jsx)(g.Z,{})})})]},e))})]}),(0,a.jsx)(i.T,{h:32}),(0,a.jsxs)(i.zx,{fullWidth:!0,disabled:J||0!==D.length,onClick:I,children:[(0,a.jsx)(w.Z,{})," 게임 시작 (",E.name,", ",j.length,"명)"]}),0!==D.length&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.T,{h:16}),D.map(e=>(0,a.jsx)("div",{children:(0,a.jsxs)(i.Jd,{error:!0,children:[(0,a.jsx)(b.Z,{})," ",e]})},e)),(0,a.jsx)(i.T,{h:16}),(0,a.jsx)("div",{style:{textAlign:"center"},children:(0,a.jsx)(i.Jd,{description:!0,small:!0,style:{cursor:"pointer",textDecoration:"underline"},onClick:I,children:"경고 무시하고 등록하기"})})]})]}),(0,a.jsx)(i.T,{h:64})]}):(0,a.jsx)(i.W2,{children:(0,a.jsx)(i.at,{children:"관리자가 아닙니다."})})}},6649:function(e,t,n){"use strict";var s=n(2805),a=n(9268),l=n(3335),i=n(1527);function r(){let e=(0,s._)(["\n  height: 1.2em;\n  width: 1.2em;\n  margin: 0 0.05em 0 0.1em;\n  vertical-align: -0.25em;\n"]);return r=function(){return e},e}let o=e=>"https://twemoji.maxcdn.com/v/latest/72x72/".concat(e,".png"),d=l.default.img(r()),c=e=>{let{emoji:t}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(d,{src:o(i.Z.convert.toCodePoint(t)),alt:t})})};t.Z=c},3133:function(e,t,n){"use strict";var s=n(2805),a=n(9268),l=n(3383),i=n(3335),r=n(1835),o=n(6649);function d(){let e=(0,s._)(["\n  display: inline-block;\n  text-align: center;\n  width: 2em;\n"]);return d=function(){return e},e}let c=i.default.span(d()),h=l.map(e=>({label:e.name,value:e.id,emoji:e.emoji})).sort((e,t)=>"custom"===e.value?1:"custom"===t.value?-1:e.label.localeCompare(t.label)),m=e=>{let{value:t,onChange:n,...s}=e;return(0,a.jsx)(r.Ph,{items:h,value:t,render:e=>{let{label:t,emoji:n}=e;return(0,a.jsxs)("span",{children:[(0,a.jsx)(c,{children:(0,a.jsx)(o.Z,{emoji:n})}),t]})},onChange:e=>n(e),...s})};t.Z=m},2665:function(e,t,n){"use strict";var s=n(6006);let a=e=>{let[t,n]=(0,s.useState)(Date.now()),[a,l]=(0,s.useState)(0);return(0,s.useEffect)(()=>{let e=setInterval(()=>{n(Date.now())},1e3);return()=>{clearInterval(e)}},[]),(0,s.useEffect)(()=>{e instanceof Date?l(t-e.getTime()):l(t-e)},[t,e]),a};t.Z=a},6192:function(e,t,n){"use strict";var s=n(3328),a=n(4890),l=n(6006);let i=()=>{let[e,t]=(0,l.useState)([]);return(0,l.useEffect)(()=>{let e=(0,a.jM)((0,a.iH)(s.db,"games"),e=>{if(e.exists()){let n=e.toJSON();t(Object.values(n).map(e=>({...e,players:Object.values(e.players),..."result"in e?{result:Object.values(e.result)}:{}})))}});return()=>e()},[]),e};t.Z=i},9519:function(e,t,n){"use strict";n.d(t,{r:function(){return a}});var s=n(3383);let a=e=>s.find(t=>t.id===e)},3383:function(e){"use strict";e.exports=JSON.parse('[{"id":"terraforming-mars","name":"테라포밍 마스","emoji":"\uD83C\uDF0D","players":{"min":1,"max":5},"estimatedPlayTime":{"min":90,"max":120}},{"id":"sakura-arms","name":"벚꽃 내리는 시대에 결투를","emoji":"\uD83C\uDF38","players":{"min":2,"max":2},"estimatedPlayTime":{"min":10,"max":20}},{"id":"halli-galli","name":"할리갈리","emoji":"\uD83C\uDF4B","players":{"min":2,"max":7},"estimatedPlayTime":{"min":5,"max":15}},{"id":"chess","name":"체스","emoji":"♟","players":{"min":2,"max":2},"estimatedPlayTime":{"min":30,"max":60}},{"id":"crazy-time","name":"크레이지 타임","emoji":"\uD83D\uDD70","players":{"min":3,"max":14},"estimatedPlayTime":{"min":20,"max":30}},{"id":"dominion","name":"도미니언","emoji":"\uD83C\uDFF0","players":{"min":2,"max":4},"estimatedPlayTime":{"min":30,"max":40}},{"id":"splendor","name":"스플렌더","emoji":"\uD83D\uDC8E","players":{"min":2,"max":4},"estimatedPlayTime":{"min":20,"max":30}},{"id":"yacht-dice","name":"요트 다이스","emoji":"\uD83C\uDFB2","players":{"min":1,"max":20},"estimatedPlayTime":{"min":5,"max":20}},{"id":"no-thanks","name":"노 땡스!","emoji":"\uD83D\uDE45‍♂️","players":{"min":3,"max":7},"estimatedPlayTime":{"min":20,"max":30}},{"id":"uno","name":"UNO","emoji":"\uD83C\uDCCF","players":{"min":2,"max":10},"estimatedPlayTime":{"min":20,"max":30}},{"id":"bang","name":"뱅!","emoji":"\uD83D\uDD2B","players":{"min":4,"max":7},"estimatedPlayTime":{"min":20,"max":40}},{"id":"zenga","name":"젠가","emoji":"\uD83D\uDCE6","players":{"min":1,"max":8},"estimatedPlayTime":{"min":5,"max":20}},{"id":"richii-mahjong","name":"리치 마작","emoji":"\uD83C\uDC04","players":{"min":3,"max":4},"estimatedPlayTime":{"min":30,"max":60}},{"id":"custom","name":"직접 입력","emoji":"\uD83D\uDCDD","players":{"min":1,"max":20},"estimatedPlayTime":{"min":5,"max":120}}]')},6628:function(e){"use strict";e.exports=JSON.parse('[{"handle":"havana723","type":"staff","solves":0},{"handle":"shiftpsh","type":"staff","solves":0},{"handle":"HYEA","type":"staff","solves":0},{"handle":"YouYoung","type":"staff","solves":0},{"handle":"chansol","type":"staff","solves":0},{"handle":"16silver","type":"staff","solves":0},{"handle":"crescent_h","type":"staff","solves":0},{"handle":"pichulia","type":"staff","solves":0},{"handle":"ai4youej","type":"contestant","solves":5},{"handle":"alsrb0504","type":"contestant","solves":6},{"handle":"alswnssl0528","type":"contestant","solves":6},{"handle":"amylo","type":"contestant","solves":5},{"handle":"arietis","type":"contestant","solves":5},{"handle":"asd122032","type":"contestant","solves":4},{"handle":"asdhugh1","type":"contestant","solves":5},{"handle":"atopi0827","type":"contestant","solves":2},{"handle":"Aunps","type":"contestant","solves":2},{"handle":"BothEarRim","type":"contestant","solves":5},{"handle":"cdg0228","type":"contestant","solves":4},{"handle":"cjh970422","type":"contestant","solves":4},{"handle":"djeleanor2","type":"contestant","solves":2},{"handle":"dlalsdn1009","type":"contestant","solves":1},{"handle":"duwang2580","type":"contestant","solves":4},{"handle":"haruki291sa","type":"contestant","solves":6},{"handle":"hijkl2e","type":"contestant","solves":9},{"handle":"hjroh0315","type":"contestant","solves":6},{"handle":"hopedream","type":"contestant","solves":3},{"handle":"ji0513ji","type":"contestant","solves":3},{"handle":"jk410","type":"contestant","solves":7},{"handle":"jshyun912","type":"contestant","solves":3},{"handle":"kimingan","type":"contestant","solves":1},{"handle":"kongum","type":"contestant","solves":3},{"handle":"lambda","type":"contestant","solves":6},{"handle":"maple0118","type":"contestant","solves":1},{"handle":"martinok1103","type":"contestant","solves":7},{"handle":"mjhmjh1104","type":"contestant","solves":7},{"handle":"nowdragon12","type":"contestant","solves":3},{"handle":"nunebin","type":"contestant","solves":5},{"handle":"nureongi0214","type":"contestant","solves":3},{"handle":"old_man_and_the_sea","type":"contestant","solves":6},{"handle":"pani","type":"contestant","solves":6},{"handle":"plan_pt","type":"contestant","solves":3},{"handle":"pridom1118","type":"contestant","solves":3},{"handle":"qwerasdfzxcl","type":"contestant","solves":4},{"handle":"riroan","type":"contestant","solves":6},{"handle":"ruykun","type":"contestant","solves":6},{"handle":"sangchoo1201","type":"contestant","solves":5},{"handle":"sch314","type":"contestant","solves":5},{"handle":"seawon0808","type":"contestant","solves":6},{"handle":"shoo040113","type":"contestant","solves":7},{"handle":"smiley07","type":"contestant","solves":5},{"handle":"star7sss","type":"contestant","solves":1},{"handle":"sunso514","type":"contestant","solves":5},{"handle":"swyjs","type":"contestant","solves":3},{"handle":"tankgewehr","type":"contestant","solves":4},{"handle":"tlsdydaud1","type":"contestant","solves":7},{"handle":"toycartoon","type":"contestant","solves":3},{"handle":"utilforever","type":"contestant","solves":4},{"handle":"vyu","type":"contestant","solves":5},{"handle":"w8385","type":"contestant","solves":5},{"handle":"wanderkind","type":"contestant","solves":2},{"handle":"wapas","type":"contestant","solves":7},{"handle":"wizardrabbit","type":"contestant","solves":7},{"handle":"wnstjd732","type":"contestant","solves":6}]')}},function(e){e.O(0,[169,454,759,770,697,459,392,445,219,2,667,139,744],function(){return e(e.s=4910)}),_N_E=e.O()}]);